"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[163],{4267:(e,o,r)=>{r.d(o,{$:()=>d});var t=r(5155),i=r(2115),s=r(2085),a=r(2596),n=r(9688);let l=(0,s.F)("inline-flex items-center justify-center rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-offset-2 disabled:opacity-50 disabled:pointer-events-none ring-offset-background",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"underline-offset-4 hover:underline text-primary"},size:{default:"h-10 py-2 px-4",sm:"h-9 px-3 rounded-md",lg:"h-11 px-8 rounded-md"}},defaultVariants:{variant:"default",size:"default"}}),d=i.forwardRef((e,o)=>{let{className:r,variant:i,size:s,asChild:d=!1,...h}=e;return(0,t.jsx)("button",{className:function(){for(var e=arguments.length,o=Array(e),r=0;r<e;r++)o[r]=arguments[r];return(0,n.QP)((0,a.$)(o))}(l({variant:i,size:s,className:r})),ref:o,...h})});d.displayName="Button"},4273:(e,o,r)=>{r.d(o,{A:()=>I});var t=r(5155),i=r(7558),s=r(3859),a=r(1914),n=r(4958),l=r(7634),d=r(4688),h=r(2515),c=r(2115),u=r(3816),x=r(6047),g=r(3264);function p(e){let{position:o}=e;return(0,t.jsxs)("group",{position:o,children:[(0,t.jsx)(x.az,{args:[1.2,.05,.8],position:[0,.6,0],children:(0,t.jsx)("meshStandardMaterial",{color:"#8B4513"})}),(0,t.jsx)(x.az,{args:[.05,.6,.05],position:[.5,.3,.3],children:(0,t.jsx)("meshStandardMaterial",{color:"#8B4513"})}),(0,t.jsx)(x.az,{args:[.05,.6,.05],position:[.5,.3,-.3],children:(0,t.jsx)("meshStandardMaterial",{color:"#8B4513"})}),(0,t.jsx)(x.az,{args:[.05,.6,.05],position:[-.5,.3,.3],children:(0,t.jsx)("meshStandardMaterial",{color:"#8B4513"})}),(0,t.jsx)(x.az,{args:[.05,.6,.05],position:[-.5,.3,-.3],children:(0,t.jsx)("meshStandardMaterial",{color:"#8B4513"})})]})}function m(e){let{position:o}=e;return(0,t.jsxs)("group",{position:o,children:[(0,t.jsx)(x.az,{args:[.5,.05,.5],position:[0,.45,0],children:(0,t.jsx)("meshStandardMaterial",{color:"#A0522D"})}),(0,t.jsx)(x.az,{args:[.5,.5,.05],position:[0,.7,-.225],children:(0,t.jsx)("meshStandardMaterial",{color:"#A0522D"})}),(0,t.jsx)(x.az,{args:[.05,.45,.05],position:[-.2,.225,.2],children:(0,t.jsx)("meshStandardMaterial",{color:"#A0522D"})}),(0,t.jsx)(x.az,{args:[.05,.45,.05],position:[.2,.225,.2],children:(0,t.jsx)("meshStandardMaterial",{color:"#A0522D"})}),(0,t.jsx)(x.az,{args:[.05,.45,.05],position:[-.2,.225,-.2],children:(0,t.jsx)("meshStandardMaterial",{color:"#A0522D"})}),(0,t.jsx)(x.az,{args:[.05,.45,.05],position:[.2,.225,-.2],children:(0,t.jsx)("meshStandardMaterial",{color:"#A0522D"})})]})}function f(e){let{position:o,dimensions:r}=e;return(0,t.jsxs)("group",{position:o,children:[(0,t.jsx)(x.az,{args:[1.8,.3,.9],position:[0,.15,0],children:(0,t.jsx)("meshStandardMaterial",{color:"#FFE4C4"})}),(0,t.jsx)(x.az,{args:[2,.1,1],position:[0,.05,0],children:(0,t.jsx)("meshStandardMaterial",{color:"#8B4513"})}),(0,t.jsx)(x.az,{args:[.5,.1,.7],position:[.6,.35,0],children:(0,t.jsx)("meshStandardMaterial",{color:"#FFFFFF"})}),(0,t.jsx)(x.az,{args:[2,.8,.1],position:[0,.4,-.55],children:(0,t.jsx)("meshStandardMaterial",{color:"#8B4513"})})]})}function j(e){let{position:o}=e;return(0,t.jsxs)("group",{position:o,children:[(0,t.jsx)(x.az,{args:[1.2,2.2,.6],position:[0,1.1,0],children:(0,t.jsx)("meshStandardMaterial",{color:"#A0522D"})}),(0,t.jsx)(x.az,{args:[.59,2.1,.05],position:[-.3,1.1,.325],children:(0,t.jsx)("meshStandardMaterial",{color:"#D2B48C"})}),(0,t.jsx)(x.az,{args:[.59,2.1,.05],position:[.3,1.1,.325],children:(0,t.jsx)("meshStandardMaterial",{color:"#D2B48C"})}),(0,t.jsx)(x.az,{args:[.05,.05,.05],position:[-.1,1.1,.35],children:(0,t.jsx)("meshStandardMaterial",{color:"#FFFFFF",metalness:.8})}),(0,t.jsx)(x.az,{args:[.05,.05,.05],position:[.1,1.1,.35],children:(0,t.jsx)("meshStandardMaterial",{color:"#FFFFFF",metalness:.8})})]})}function w(e){let{position:o}=e;return(0,t.jsxs)("group",{position:o,children:[(0,t.jsx)(x.az,{args:[2,.5,.8],position:[0,.25,0],children:(0,t.jsx)("meshStandardMaterial",{color:"#8B4513"})}),(0,t.jsx)(x.az,{args:[1.9,.15,.7],position:[0,.55,0],children:(0,t.jsx)("meshStandardMaterial",{color:"#D2B48C"})}),(0,t.jsx)(x.az,{args:[2,.5,.15],position:[0,.8,-.4],children:(0,t.jsx)("meshStandardMaterial",{color:"#D2B48C"})}),(0,t.jsx)(x.az,{args:[.15,.3,.8],position:[-1,.4,0],children:(0,t.jsx)("meshStandardMaterial",{color:"#D2B48C"})}),(0,t.jsx)(x.az,{args:[.15,.3,.8],position:[1,.4,0],children:(0,t.jsx)("meshStandardMaterial",{color:"#D2B48C"})}),(0,t.jsx)(x.az,{args:[.4,.1,.4],position:[-.7,.65,0],children:(0,t.jsx)("meshStandardMaterial",{color:"#F5F5DC"})}),(0,t.jsx)(x.az,{args:[.4,.1,.4],position:[.7,.65,0],children:(0,t.jsx)("meshStandardMaterial",{color:"#F5F5DC"})})]})}function b(e){let{position:o}=e;return(0,t.jsxs)("group",{position:o,children:[(0,t.jsx)(x.T,{args:[.8,.8,.05,32],position:[0,.7,0],rotation:[Math.PI/2,0,0],children:(0,t.jsx)("meshStandardMaterial",{color:"#D2B48C"})}),(0,t.jsx)(x.T,{args:[.1,.15,.7,32],position:[0,.35,0],children:(0,t.jsx)("meshStandardMaterial",{color:"#8B4513"})}),(0,t.jsx)(x.T,{args:[.3,.3,.05,32],position:[0,0,0],children:(0,t.jsx)("meshStandardMaterial",{color:"#8B4513"})})]})}function y(e){let{position:o}=e;return(0,t.jsxs)("group",{position:o,children:[(0,t.jsx)(x.az,{args:[1.2,2,.05],position:[0,1,-.25],children:(0,t.jsx)("meshStandardMaterial",{color:"#A0522D"})}),(0,t.jsx)(x.az,{args:[.05,2,.5],position:[-.6,1,0],children:(0,t.jsx)("meshStandardMaterial",{color:"#A0522D"})}),(0,t.jsx)(x.az,{args:[.05,2,.5],position:[.6,1,0],children:(0,t.jsx)("meshStandardMaterial",{color:"#A0522D"})}),(0,t.jsx)(x.az,{args:[1.2,.05,.5],position:[0,0,0],children:(0,t.jsx)("meshStandardMaterial",{color:"#A0522D"})}),(0,t.jsx)(x.az,{args:[1.2,.05,.5],position:[0,.5,0],children:(0,t.jsx)("meshStandardMaterial",{color:"#A0522D"})}),(0,t.jsx)(x.az,{args:[1.2,.05,.5],position:[0,1,0],children:(0,t.jsx)("meshStandardMaterial",{color:"#A0522D"})}),(0,t.jsx)(x.az,{args:[1.2,.05,.5],position:[0,1.5,0],children:(0,t.jsx)("meshStandardMaterial",{color:"#A0522D"})}),(0,t.jsx)(x.az,{args:[1.2,.05,.5],position:[0,2,0],children:(0,t.jsx)("meshStandardMaterial",{color:"#A0522D"})}),(0,t.jsx)(x.az,{args:[.2,.3,.15],position:[-.4,.2,0],children:(0,t.jsx)("meshStandardMaterial",{color:"red"})}),(0,t.jsx)(x.az,{args:[.3,.3,.15],position:[0,.2,0],children:(0,t.jsx)("meshStandardMaterial",{color:"blue"})}),(0,t.jsx)(x.az,{args:[.25,.3,.15],position:[.4,.2,0],children:(0,t.jsx)("meshStandardMaterial",{color:"green"})})]})}function M(e){let{position:o}=e;return(0,t.jsxs)("group",{position:o,children:[(0,t.jsx)(x.az,{args:[2,.9,.6],position:[0,.45,0],children:(0,t.jsx)("meshStandardMaterial",{color:"#D3D3D3"})}),(0,t.jsx)(x.az,{args:[2.1,.05,.65],position:[0,.95,0],children:(0,t.jsx)("meshStandardMaterial",{color:"#2F4F4F"})}),(0,t.jsx)(x.az,{args:[.6,.05,.4],position:[-.6,.96,0],children:(0,t.jsx)("meshStandardMaterial",{color:"#C0C0C0",metalness:.5})}),(0,t.jsx)(x.az,{args:[2,.7,.4],position:[0,1.85,-.1],children:(0,t.jsx)("meshStandardMaterial",{color:"#D3D3D3"})}),(0,t.jsx)(x.az,{args:[.05,.05,.05],position:[-.8,.5,.3],children:(0,t.jsx)("meshStandardMaterial",{color:"#808080"})}),(0,t.jsx)(x.az,{args:[.05,.05,.05],position:[-.3,.5,.3],children:(0,t.jsx)("meshStandardMaterial",{color:"#808080"})}),(0,t.jsx)(x.az,{args:[.05,.05,.05],position:[.3,.5,.3],children:(0,t.jsx)("meshStandardMaterial",{color:"#808080"})}),(0,t.jsx)(x.az,{args:[.05,.05,.05],position:[.8,.5,.3],children:(0,t.jsx)("meshStandardMaterial",{color:"#808080"})})]})}function S(e){let{position:o}=e;return(0,t.jsxs)("group",{position:o,children:[(0,t.jsx)(x.az,{args:[1.2,.7,.05],position:[0,1.4,0],children:(0,t.jsx)("meshStandardMaterial",{color:"#000000"})}),(0,t.jsx)(x.az,{args:[.1,.5,.1],position:[0,.9,0],children:(0,t.jsx)("meshStandardMaterial",{color:"#696969"})}),(0,t.jsx)(x.az,{args:[.6,.05,.4],position:[0,.65,0],children:(0,t.jsx)("meshStandardMaterial",{color:"#696969"})})]})}function v(e){let{children:o,position:r,onPositionChange:i,bounds:s,onDelete:a}=e,n=(0,c.useRef)(null),l=(0,c.useRef)(!1),d=(0,c.useRef)([0,0,0]),[h,x]=(0,c.useState)(0),[g,p]=(0,c.useState)(!1);return(0,u.C)(()=>{x(e=>{let o=g?1.15:1;return e<o?Math.min(o,e+.08):e>o?Math.max(o,e-.08):e}),n.current&&n.current.scale.set(h,h,h),n.current&&n.current.traverse(e=>{e.isMesh&&(e.material.emissive=e.material.emissive||{set:()=>{}},e.material.emissive.set(g?"#ffe066":"#000"))})}),(0,t.jsx)("group",{ref:n,position:r,onPointerDown:e=>{e.stopPropagation(),l.current=!0,p(!0),d.current=[e.point.x-r[0],e.point.y-r[1],e.point.z-r[2]],document.body.style.cursor="grabbing"},onPointerUp:e=>{l.current=!1,p(!1),document.body.style.cursor="auto"},onPointerMove:e=>{if(!l.current)return;let o=e.point.x-d.current[0],t=e.point.z-d.current[2];o=Math.max(s.xMin,Math.min(s.xMax,o)),t=Math.max(s.zMin,Math.min(s.zMax,t)),i([o,r[1],t])},onPointerOver:()=>p(!0),onPointerOut:()=>p(!1),onDoubleClick:e=>{e.stopPropagation(),a()},castShadow:!0,children:o})}function C(e){let{furnitureItems:o,dimensions:r}=e,i={table:[0,0,0],chair1:[-.7,0,0],chair2:[.7,0,0],bed:[0,0,-r.length/2+1],wardrobe:[r.width/2-.7,0,-r.length/2+.4],sofa:[-r.width/2+1.1,0,0],dining_table:[0,0,r.length/2-1.5],bookshelf:[r.width/2-.7,0,r.length/2-.4],kitchen:[-r.width/2+1.1,0,r.length/2-.4],tv:[0,0,-r.width/2+.1]},[s,a]=(0,c.useState)(i),[n,l]=(0,c.useState)(o),d={xMin:-r.width/2+.6,xMax:r.width/2-.6,zMin:-r.length/2+.6,zMax:r.length/2-.6},h=e=>{l(o=>o.filter(o=>o!==e&&"chairs"!==o||"chair1"===e&&"chair2"!==o||"chair2"===e&&"chair1"!==o))},u=[];return n.includes("table")&&u.push((0,t.jsx)(v,{position:s.table,onPositionChange:e=>a(o=>({...o,table:e})),bounds:d,onDelete:()=>h("table"),children:(0,t.jsx)(p,{position:[0,0,0]})},"table")),n.includes("chairs")&&u.push((0,t.jsx)(v,{position:s.chair1,onPositionChange:e=>a(o=>({...o,chair1:e})),bounds:d,onDelete:()=>h("chairs"),children:(0,t.jsx)(m,{position:[0,0,0]})},"chair1"),(0,t.jsx)(v,{position:s.chair2,onPositionChange:e=>a(o=>({...o,chair2:e})),bounds:d,onDelete:()=>h("chairs"),children:(0,t.jsx)(m,{position:[0,0,0]})},"chair2")),n.includes("bed")&&u.push((0,t.jsx)(v,{position:s.bed,onPositionChange:e=>a(o=>({...o,bed:e})),bounds:d,onDelete:()=>h("bed"),children:(0,t.jsx)(f,{position:[0,0,0],dimensions:r})},"bed")),n.includes("wardrobe")&&u.push((0,t.jsx)(v,{position:s.wardrobe,onPositionChange:e=>a(o=>({...o,wardrobe:e})),bounds:d,onDelete:()=>h("wardrobe"),children:(0,t.jsx)(j,{position:[0,0,0]})},"wardrobe")),n.includes("sofa")&&u.push((0,t.jsx)(v,{position:s.sofa,onPositionChange:e=>a(o=>({...o,sofa:e})),bounds:d,onDelete:()=>h("sofa"),children:(0,t.jsx)(w,{position:[0,0,0]})},"sofa")),n.includes("dining_table")&&u.push((0,t.jsx)(v,{position:s.dining_table,onPositionChange:e=>a(o=>({...o,dining_table:e})),bounds:d,onDelete:()=>h("dining_table"),children:(0,t.jsx)(b,{position:[0,0,0]})},"dining_table")),n.includes("bookshelf")&&u.push((0,t.jsx)(v,{position:s.bookshelf,onPositionChange:e=>a(o=>({...o,bookshelf:e})),bounds:d,onDelete:()=>h("bookshelf"),children:(0,t.jsx)(y,{position:[0,0,0]})},"bookshelf")),n.includes("kitchen")&&u.push((0,t.jsx)(v,{position:s.kitchen,onPositionChange:e=>a(o=>({...o,kitchen:e})),bounds:d,onDelete:()=>h("kitchen"),children:(0,t.jsx)(M,{position:[0,0,0]})},"kitchen")),n.includes("tv")&&u.push((0,t.jsx)(v,{position:s.tv,onPositionChange:e=>a(o=>({...o,tv:e})),bounds:d,onDelete:()=>h("tv"),children:(0,t.jsx)(S,{position:[0,0,0]})},"tv")),(0,t.jsx)(t.Fragment,{children:u})}function z(e){let{config:o={dimensions:{width:2.4,length:6,height:2.5},doorPosition:"front",windowsCount:2,roofType:"flat",exteriorColor:"#f0f0f0",roofColor:"#d0d0d0",doorOpen:!1,windowsOpen:!1,interiorFurniture:[],wallTexture:"standard",floorTexture:"standard",roofTexture:"standard",windowType:"standard",lightsOn:!1,windowPositions:{front:[],back:[],left:[],right:[]},viewMode:"exterior",timeOfDay:"day",weather:"clear",mapLocation:{lat:55.7558,lng:37.6173}},texturesPaths:r={standard:{wall:"/textures/wall.jpg",roof:"/textures/roof.jpg",floor:"/textures/floor.jpg"},premium:{wall:"/textures/premium/wall_premium.jpg",roof:"/textures/premium/roof_premium.jpg",floor:"/textures/premium/floor_premium.jpg"},deluxe:{wall:"/textures/deluxe/wall_deluxe.jpg",roof:"/textures/deluxe/roof_deluxe.jpg",floor:"/textures/deluxe/floor_deluxe.jpg"}}}=e,i=(0,c.useRef)(null),s=(0,c.useRef)(null),a=o.dimensions||{width:2.4,length:6,height:2.5},[n,l]=(0,c.useState)({walls:null,roof:null,floor:null,wallPremium:null,roofPremium:null,floorPremium:null,wallDeluxe:null,roofDeluxe:null,floorDeluxe:null}),d=(0,c.useRef)(null),h=(0,c.useRef)([]),[p,m]=(0,c.useState)(0),[f,j]=(0,c.useState)(0);return(0,c.useEffect)(()=>{let e,r=+!!o.doorOpen,t=+!!o.windowsOpen;return!function o(){m(e=>.01>Math.abs(e-r)?r:e+(r-e)*.15),j(e=>.01>Math.abs(e-t)?t:e+(t-e)*.15),e=requestAnimationFrame(o)}(),()=>cancelAnimationFrame(e)},[o.doorOpen,o.windowsOpen]),(0,c.useEffect)(()=>{var e,t,i;let s=new g.Tap,a=o.wallTexture&&(null==(e=r[o.wallTexture])?void 0:e.wall)||"/textures/wall.jpg";s.load(a,e=>{e.wrapS=e.wrapT=g.GJx,e.repeat.set(1,1),l(o=>({...o,walls:e}))},void 0,e=>console.error("Ошибка загрузки текстуры стен:",e));let n=o.roofTexture&&(null==(t=r[o.roofTexture])?void 0:t.roof)||"/textures/roof.jpg";s.load(n,e=>{e.wrapS=e.wrapT=g.GJx,e.repeat.set(1,1),l(o=>({...o,roof:e}))},void 0,e=>console.error("Ошибка загрузки текстуры крыши:",e));let d=o.floorTexture&&(null==(i=r[o.floorTexture])?void 0:i.floor)||"/textures/floor.jpg";s.load(d,e=>{e.wrapS=e.wrapT=g.GJx,e.repeat.set(4,4),l(o=>({...o,floor:e}))},void 0,e=>console.error("Ошибка загрузки текстуры пола:",e))},[o.wallTexture,o.roofTexture,o.floorTexture,r]),(0,u.C)(()=>{d.current&&(d.current.rotation.y=-Math.PI/2*p),h.current.forEach((e,o)=>{e&&(e.position.x=(o%2==0?1:-1)*(a.width/2+.01+.4*f))})}),(0,t.jsxs)("group",{children:[(0,t.jsxs)("group",{ref:i,position:[0,a.height/2,0],children:[(0,t.jsx)(x.az,{args:[a.width,a.height,a.length],castShadow:!0,receiveShadow:!0,children:(0,t.jsx)("meshStandardMaterial",{map:n.walls||void 0,color:o.exteriorColor||"#f0f0f0",roughness:.7,metalness:.1})}),(0,t.jsx)(x.az,{args:[a.width-.1,.1,a.length-.1],position:[0,-a.height/2+.05,0],receiveShadow:!0,children:(0,t.jsx)("meshStandardMaterial",{map:n.floor||void 0,color:"#8B4513",roughness:.8})}),(0,t.jsx)("group",{ref:d,position:["left"===o.doorPosition?-a.width/2-.01:"right"===o.doorPosition?a.width/2+.01:0,-a.height/2+1,"front"===o.doorPosition?a.length/2+.01:"back"===o.doorPosition?-a.length/2-.01:0],rotation:[0,"front"===o.doorPosition?0:"back"===o.doorPosition?Math.PI:"left"===o.doorPosition?-Math.PI/2:Math.PI/2,0],children:(0,t.jsx)(x.az,{args:[.9,2,.05],position:[0,0,0],castShadow:!0,children:(0,t.jsx)("meshStandardMaterial",{color:"#8B4513"})})}),Array.from({length:o.windowsCount||0}).map((e,o)=>(0,t.jsx)("group",{ref:e=>h.current[o]=e,position:[o%2==0?a.width/2+.01:-a.width/2-.01,0,(o<2?1:-1)*a.length/4],rotation:[0,o%2==0?Math.PI/2:-Math.PI/2,0],children:(0,t.jsx)(x.az,{args:[.8,.8,.05],castShadow:!0,children:(0,t.jsx)("meshStandardMaterial",{color:"#87CEEB",transparent:!0,opacity:.7})})},"window-".concat(o)))]}),"flat"===o.roofType&&(0,t.jsx)(x.az,{ref:s,args:[a.width+.2,.2,a.length+.2],position:[0,a.height+.1,0],castShadow:!0,receiveShadow:!0,children:(0,t.jsx)("meshStandardMaterial",{map:n.roof||void 0,color:o.roofColor||"#d0d0d0",roughness:.6})}),"gable"===o.roofType&&(0,t.jsxs)("group",{position:[0,a.height,0],children:[(0,t.jsxs)("mesh",{ref:s,children:[(0,t.jsx)("bufferGeometry",{children:(0,t.jsx)("bufferAttribute",{attach:"attributes-position",args:[new Float32Array([-a.width/2-.2,0,-a.length/2-.2,-a.width/2-.2,0,a.length/2+.2,0,.8,a.length/2+.2,-a.width/2-.2,0,-a.length/2-.2,0,.8,-a.length/2-.2,0,.8,a.length/2+.2]),3]})}),(0,t.jsx)("meshStandardMaterial",{map:n.roof||void 0,color:o.roofColor||"#d0d0d0",side:g.$EB,roughness:.6})]}),(0,t.jsxs)("mesh",{children:[(0,t.jsx)("bufferGeometry",{children:(0,t.jsx)("bufferAttribute",{attach:"attributes-position",args:[new Float32Array([a.width/2+.2,0,-a.length/2-.2,a.width/2+.2,0,a.length/2+.2,0,.8,a.length/2+.2,a.width/2+.2,0,-a.length/2-.2,0,.8,-a.length/2-.2,0,.8,a.length/2+.2]),3]})}),(0,t.jsx)("meshStandardMaterial",{map:n.roof||void 0,color:o.roofColor||"#d0d0d0",side:g.$EB,roughness:.6})]})]}),"hip"===o.roofType&&(0,t.jsxs)("mesh",{position:[0,a.height+.5,0],ref:s,children:[(0,t.jsx)("coneGeometry",{args:[Math.max(a.width,a.length)/1.5,1,4]}),(0,t.jsx)("meshStandardMaterial",{map:n.roof||void 0,color:o.roofColor||"#d0d0d0",roughness:.6})]}),"interior"===o.viewMode&&o.interiorFurniture&&o.interiorFurniture.length>0&&(0,t.jsx)(C,{furnitureItems:o.interiorFurniture,dimensions:a}),(0,t.jsxs)("mesh",{rotation:[-Math.PI/2,0,0],position:[0,-.01,0],receiveShadow:!0,children:[(0,t.jsx)("planeGeometry",{args:[20,20]}),(0,t.jsx)("meshStandardMaterial",{color:"#4b6043",roughness:1})]})]})}var D=r(4355),P=r(1981),A=r(133),k=r(2098),F=r(3509),N=r(6386),T=r(2851),B=r(381),O=r(1284),_=r(4788);function I(e){let{onConfigChange:o,buildingParams:r}=e,[u,x]=(0,c.useState)({dimensions:{width:2.4,length:6,height:2.5},doorPosition:"front",windowsCount:2,roofType:"flat",exteriorColor:"#f0f0f0",roofColor:"#d0d0d0",doorColor:"#8b4513",doorOpen:!1,windowsOpen:!1,interiorFurniture:[],wallTexture:"standard",floorTexture:"standard",roofTexture:"standard",windowType:"standard",lightsOn:!1,windowPositions:{front:[],back:[],left:[],right:[]},mapLocation:{lat:55.7558,lng:37.6173}}),[g,p]=(0,c.useState)({viewMode:"exterior",cameraPosition:"free",cameraType:"perspective",autoRotate:!1,timeOfDay:"day",weather:"clear",showLeftPanel:!0,showRightPanel:!0,showGrid:!0,showStats:!1,showInfo:!1,showHelp:!1}),[m,f]=(0,c.useState)({doorAnimation:!1,windowAnimation:!1,lightAnimation:!1,weatherAnimation:!1});(0,c.useRef)(null);let j=(0,c.useRef)(null);(0,c.useEffect)(()=>{r&&(x(e=>({...e,dimensions:{width:r.width,length:r.length,height:r.height},doorPosition:r.doorPosition,windowsCount:r.windowsCount,roofType:r.roofType,exteriorColor:r.wallColor,roofColor:r.roofColor,doorColor:r.doorColor,windowType:r.windowType,interiorFurniture:r.furniture,lightsOn:r.electricity})),p(e=>({...e,timeOfDay:r.timeOfDay,weather:r.weather})))},[r]);let w=e=>{p(o=>({...o,...e}))},b=(()=>{switch(g.timeOfDay){case"day":default:return{ambientIntensity:.6,directionalIntensity:1,color:"#ffffff",skyColor:"#87CEEB"};case"night":return{ambientIntensity:.2,directionalIntensity:.1,color:"#1a1a2e",skyColor:"#0f0f23"};case"sunset":return{ambientIntensity:.4,directionalIntensity:.8,color:"#ff7f50",skyColor:"#ff6b6b"}}})(),y=(()=>{switch(g.weather){case"rain":return{particles:!0,particleCount:1e3,particleColor:"#4a90e2",fog:!0,fogDensity:.02};case"snow":return{particles:!0,particleCount:500,particleColor:"#ffffff",fog:!0,fogDensity:.01};default:return{particles:!1,particleCount:0,particleColor:"#ffffff",fog:!1,fogDensity:0}}})();return(0,t.jsxs)("div",{className:"relative w-full h-full bg-gradient-to-br from-blue-50 to-indigo-50",children:[(0,t.jsx)("div",{className:"absolute top-4 left-4 right-4 z-10",children:(0,t.jsx)("div",{className:"bg-white/90 backdrop-blur-sm rounded-xl p-4 shadow-lg border border-gray-200",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{className:"flex items-center gap-4",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("button",{onClick:()=>w({cameraPosition:"front"}),className:"p-2 rounded-lg transition-colors ".concat("front"===g.cameraPosition?"bg-blue-600 text-white":"bg-gray-100 text-gray-600 hover:bg-gray-200"),title:"Вид спереди",children:(0,t.jsx)(D.A,{className:"w-4 h-4"})}),(0,t.jsx)("button",{onClick:()=>w({cameraPosition:"top"}),className:"p-2 rounded-lg transition-colors ".concat("top"===g.cameraPosition?"bg-blue-600 text-white":"bg-gray-100 text-gray-600 hover:bg-gray-200"),title:"Вид сверху",children:(0,t.jsx)(P.A,{className:"w-4 h-4"})}),(0,t.jsx)("button",{onClick:()=>w({autoRotate:!g.autoRotate}),className:"p-2 rounded-lg transition-colors ".concat(g.autoRotate?"bg-blue-600 text-white":"bg-gray-100 text-gray-600 hover:bg-gray-200"),title:"Автоповорот",children:(0,t.jsx)(A.A,{className:"w-4 h-4"})})]}),(0,t.jsx)("div",{className:"h-6 w-px bg-gray-300"}),(0,t.jsx)("div",{className:"flex items-center gap-2",children:[{id:"day",icon:k.A,label:"День"},{id:"night",icon:F.A,label:"Ночь"},{id:"sunset",icon:k.A,label:"Закат"}].map(e=>{let{id:o,icon:r,label:i}=e;return(0,t.jsx)("button",{onClick:()=>w({timeOfDay:o}),className:"p-2 rounded-lg transition-colors ".concat(g.timeOfDay===o?"bg-blue-600 text-white":"bg-gray-100 text-gray-600 hover:bg-gray-200"),title:i,children:(0,t.jsx)(r,{className:"w-4 h-4"})},o)})}),(0,t.jsx)("div",{className:"h-6 w-px bg-gray-300"}),(0,t.jsx)("div",{className:"flex items-center gap-2",children:[{id:"clear",icon:k.A,label:"Ясно"},{id:"rain",icon:N.A,label:"Дождь"},{id:"snow",icon:T.A,label:"Снег"}].map(e=>{let{id:o,icon:r,label:i}=e;return(0,t.jsx)("button",{onClick:()=>w({weather:o}),className:"p-2 rounded-lg transition-colors ".concat(g.weather===o?"bg-blue-600 text-white":"bg-gray-100 text-gray-600 hover:bg-gray-200"),title:i,children:(0,t.jsx)(r,{className:"w-4 h-4"})},o)})})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("button",{onClick:()=>w({showGrid:!g.showGrid}),className:"p-2 rounded-lg transition-colors ".concat(g.showGrid?"bg-blue-600 text-white":"bg-gray-100 text-gray-600 hover:bg-gray-200"),title:"Сетка",children:(0,t.jsx)(B.A,{className:"w-4 h-4"})}),(0,t.jsx)("button",{onClick:()=>w({showStats:!g.showStats}),className:"p-2 rounded-lg transition-colors ".concat(g.showStats?"bg-blue-600 text-white":"bg-gray-100 text-gray-600 hover:bg-gray-200"),title:"Статистика",children:(0,t.jsx)(O.A,{className:"w-4 h-4"})}),(0,t.jsx)("button",{onClick:()=>w({showHelp:!g.showHelp}),className:"p-2 rounded-lg transition-colors ".concat(g.showHelp?"bg-blue-600 text-white":"bg-gray-100 text-gray-600 hover:bg-gray-200"),title:"Помощь",children:(0,t.jsx)(_.A,{className:"w-4 h-4"})})]})]})})}),(0,t.jsxs)(i.Hl,{camera:{position:(()=>{let{width:e,length:o,height:r}=u.dimensions,t=3*Math.max(e,o,r);switch(g.cameraPosition){case"front":return[0,.7*r,t];case"back":return[0,.7*r,-t];case"left":return[-t,.7*r,0];case"right":return[t,.7*r,0];case"top":return[0,t,0];default:return[.7*t,.7*r,.7*t]}})(),fov:60,near:.1,far:1e3},shadows:!0,gl:{antialias:!0,alpha:!0,powerPreference:"high-performance"},className:"w-full h-full",children:[g.showStats&&(0,t.jsx)(s.U,{}),(0,t.jsx)("ambientLight",{intensity:b.ambientIntensity,color:b.color}),(0,t.jsx)("directionalLight",{position:[10,10,5],intensity:b.directionalIntensity,castShadow:!0,"shadow-mapSize-width":2048,"shadow-mapSize-height":2048,"shadow-camera-far":50,"shadow-camera-left":-10,"shadow-camera-right":10,"shadow-camera-top":10,"shadow-camera-bottom":-10}),"night"===g.timeOfDay?(0,t.jsx)(a.A,{radius:100,depth:50,count:5e3,factor:4,saturation:0,fade:!0,speed:1}):(0,t.jsx)(n.m,{distance:45e4,sunPosition:[0,1,0],inclination:0,azimuth:.25,rayleigh:.5,turbidity:10,mieCoefficient:.005,mieDirectionalG:.8}),y.particles&&(0,t.jsx)("group",{children:Array.from({length:y.particleCount}).map((e,o)=>(0,t.jsxs)("mesh",{position:[(Math.random()-.5)*20,10*Math.random()+5,(Math.random()-.5)*20],children:[(0,t.jsx)("sphereGeometry",{args:[.02,8,8]}),(0,t.jsx)("meshBasicMaterial",{color:y.particleColor,transparent:!0,opacity:.6})]},o))}),g.showGrid&&(0,t.jsx)(l.x,{args:[20,20],cellSize:1,cellThickness:.5,cellColor:"#6f6f6f",sectionSize:5,sectionThickness:1,sectionColor:"#9d4b4b",fadeDistance:25,fadeStrength:1,followCamera:!1,infiniteGrid:!0}),(0,t.jsx)(c.Suspense,{fallback:null,children:(0,t.jsx)(z,{config:u,texturesPaths:{standard:{wall:"/textures/wall.jpg",roof:"/textures/roof.jpg",floor:"/textures/floor.jpg"},premium:{wall:"/textures/premium/wall_premium.jpg",roof:"/textures/premium/roof_premium.jpg",floor:"/textures/premium/floor_premium.jpg"},deluxe:{wall:"/textures/deluxe/wall_deluxe.jpg",roof:"/textures/deluxe/roof_deluxe.jpg",floor:"/textures/deluxe/floor_deluxe.jpg"}}})}),(0,t.jsx)(d.N,{ref:j,enablePan:!0,enableZoom:!0,enableRotate:!0,autoRotate:g.autoRotate,autoRotateSpeed:1,maxDistance:50,minDistance:2,maxPolarAngle:Math.PI,minPolarAngle:0}),(0,t.jsx)(h.OH,{preset:"sunset"})]}),g.showInfo&&(0,t.jsxs)("div",{className:"absolute bottom-4 left-4 bg-white/90 backdrop-blur-sm rounded-xl p-4 shadow-lg border border-gray-200 max-w-sm",children:[(0,t.jsx)("h3",{className:"font-semibold text-gray-800 mb-2",children:"Информация о проекте"}),(0,t.jsxs)("div",{className:"space-y-1 text-sm text-gray-600",children:[(0,t.jsxs)("div",{children:["Размеры: ",u.dimensions.width,"\xd7",u.dimensions.length,"\xd7",u.dimensions.height," м"]}),(0,t.jsxs)("div",{children:["Площадь: ",(u.dimensions.width*u.dimensions.length).toFixed(1)," м\xb2"]}),(0,t.jsxs)("div",{children:["Крыша: ",u.roofType]}),(0,t.jsxs)("div",{children:["Окна: ",u.windowsCount," шт."]}),(0,t.jsxs)("div",{children:["Дверь: ",u.doorPosition]})]})]}),g.showHelp&&(0,t.jsxs)("div",{className:"absolute bottom-4 right-4 bg-white/90 backdrop-blur-sm rounded-xl p-4 shadow-lg border border-gray-200 max-w-sm",children:[(0,t.jsx)("h3",{className:"font-semibold text-gray-800 mb-2",children:"Управление"}),(0,t.jsxs)("div",{className:"space-y-1 text-sm text-gray-600",children:[(0,t.jsx)("div",{children:"• ЛКМ + перетаскивание - поворот камеры"}),(0,t.jsx)("div",{children:"• Колесо мыши - масштабирование"}),(0,t.jsx)("div",{children:"• ПКМ + перетаскивание - панорамирование"}),(0,t.jsx)("div",{children:"• Двойной клик - сброс камеры"})]})]})]})}}}]);